# ERP Servlet Backend (No Frontend)

Java Servlet backend (WAR) exposing REST-like endpoints, using Oracle (PL/SQL) via JDBC + HikariCP. Designed for Postman/cURL instead of a browser UI.

## Requirements
- JDK 17+
- Maven 3.8+
- Oracle DB reachable from this app
  - Set env vars: `ORACLE_JDBC_URL`, `ORACLE_DB_USER`, `ORACLE_DB_PASSWORD`

## Run (Jetty)
```bash
cd erp-servlet
mvn -q clean package
mvn -q org.eclipse.jetty:jetty-maven-plugin:run
```
- Server: http://localhost:8080
- Health: GET `/health`
- Products: `/api/products`

## Example Requests (Postman or curl)
- Create:
```bash
curl -X POST http://localhost:8080/api/products \
  -H 'Content-Type: application/json' \
  -d '{"name":"Laptop","price":1299.99}'
```
- List:
```bash
curl http://localhost:8080/api/products
```
- Get by id:
```bash
curl http://localhost:8080/api/products/1
```
- Update:
```bash
curl -X PUT http://localhost:8080/api/products/1 \
  -H 'Content-Type: application/json' \
  -d '{"name":"Laptop Pro","price":1499.99}'
```
- Delete:
```bash
curl -X DELETE http://localhost:8080/api/products/1
```

## Database Setup (Oracle)
Run this DDL and PL/SQL package in your Oracle schema.

```sql
CREATE TABLE products (
    id         NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    name       VARCHAR2(200) NOT NULL,
    price      NUMBER(12,2) NOT NULL,
    created_at TIMESTAMP DEFAULT SYSTIMESTAMP
);
```

```sql
CREATE OR REPLACE PACKAGE pkg_product AS
  PROCEDURE create_product(p_name IN VARCHAR2, p_price IN NUMBER, p_id OUT NUMBER);
  PROCEDURE get_product(p_id IN NUMBER, p_cursor OUT SYS_REFCURSOR);
  PROCEDURE update_product(p_id IN NUMBER, p_name IN VARCHAR2, p_price IN NUMBER, p_rows OUT INTEGER);
  PROCEDURE delete_product(p_id IN NUMBER, p_rows OUT INTEGER);
END pkg_product;
/

CREATE OR REPLACE PACKAGE BODY pkg_product AS
  PROCEDURE create_product(p_name IN VARCHAR2, p_price IN NUMBER, p_id OUT NUMBER) IS
  BEGIN
    INSERT INTO products(name, price) VALUES(p_name, p_price)
    RETURNING id INTO p_id;
  END;

  PROCEDURE get_product(p_id IN NUMBER, p_cursor OUT SYS_REFCURSOR) IS
  BEGIN
    OPEN p_cursor FOR
      SELECT id, name, price, created_at FROM products WHERE id = p_id;
  END;

  PROCEDURE update_product(p_id IN NUMBER, p_name IN VARCHAR2, p_price IN NUMBER, p_rows OUT INTEGER) IS
  BEGIN
    UPDATE products SET name = p_name, price = p_price WHERE id = p_id;
    p_rows := SQL%ROWCOUNT;
  END;

  PROCEDURE delete_product(p_id IN NUMBER, p_rows OUT INTEGER) IS
  BEGIN
    DELETE FROM products WHERE id = p_id;
    p_rows := SQL%ROWCOUNT;
  END;
END pkg_product;
/
```

## Configuration
- Env vars (with defaults):
  - `ORACLE_JDBC_URL` default `jdbc:oracle:thin:@//localhost:1521/ORCLCDB`
  - `ORACLE_DB_USER` default `system`
  - `ORACLE_DB_PASSWORD` default `oracle`

## Packaging
```bash
mvn -q clean package
# produces target/erp-servlet.war
```

## Notes
- This is Servlet-only; no Spring.
- Swap Jetty with Tomcat by deploying the WAR.
- Adjust JDBC URL (Service Name/SID) per your Oracle setup.
